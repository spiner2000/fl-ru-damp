<div class="i-shadow i-shadow_zindex_110">
  <div class="b-shadow b-shadow_inline-block b-shadow_width_850 b-shadow_gorizont_center b-shadow_top_140" >
    <div class="b-shadow__right">
      <div class="b-shadow__left">
        <div class="b-shadow__top">
          <div class="b-shadow__bottom">
                        <div class="b-shadow__body b-shadow__body_bg_fff b-shadow__body_pad_20 b-layout">
                          <h2 class="b-shadow__title b-shadow__title_padbot_15 b-shadow__title_fontsize_22">Реальные имена &mdash; выгодные заказы</h2>
                          <div class="b-layout__txt b-layout__txt_padbot_15 b-layout__txt_fontsize_15">Основная цель фрилансера &mdash; получение прибыльных заказов.</div>
                          <div class="b-layout__txt b-layout__txt_padbot_15 b-layout__txt_fontsize_15">Взгляните на наш каталог фрилансеров. А вы бы поручили работу над своим проектом пользователю<br />
                            с вымышленным именем и не относящимся к делу рисунком на аватаре?</div>
                          <table class="b-layout__table b-layout__table_margbot_20 b-layout__table_width_full">
                            <tr class="b-layout__tr">
                              <td class="b-layout__one">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50 b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/1.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Павлик-смайлик</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50 b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/2.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Креатив webstudio</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/3.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Anna Black</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/4.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">PR SEO</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/5.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Kisa design</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/6.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Верстка недорого</div></td>
                              <td class="b-layout__one">&#160;</td>
                            </tr>
                          </table>
                          <div class="b-layout__txt b-layout__txt_padbot_15 b-layout__txt_fontsize_15">Заказчику гораздо приятнее обратиться к человеку, который открыт для деловых контактов и ничего не скрывает.</div>
                          <table class="b-layout__table b-layout__table_margbot_20 b-layout__table_width_full">
                            <tr class="b-layout__tr">
                              <td class="b-layout__one">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50 b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/11.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Ирина Пожидаева</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50 b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/12.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Максим Юрьев</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/13.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Вика Озерцова</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/14.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Петр Григорьев</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/15.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Джон Смитт</div></td>
                              <td class="b-layout__one b-layout__one_width_30">&#160;</td>
                              <td class="b-layout__one b-layout__one_width_50  b-layout__one_center"><img class="b-layout__pic" src="/images/temp/avatar/16.png" alt="" width="50" height="50" />
                                <div class="b-layout__txt b-layout__txt_fontsize_11">Николай Яшин</div></td>
                              <td class="b-layout__one">&#160;</td>
                            </tr>
                    </table>
                    <? if (!$r_data['o_inf_factor']) { ?>
                        <div class="b-layout__txt b-layout__txt_padbot_30 b-layout__txt_fontsize_11">Хотите добавить 100 баллов к своему рейтингу? Просто укажите свое имя, возраст, специализацию, город, страну и добавьте хотя бы 1 работу в портфолио по выбранной вами специализации.</div>
                    <? } ?>
                    <form action="/users/<?= $_SESSION['login'] ?>/setup/main/" method="post" id="real_name_form">
                        <input type="hidden" name="action" value="real_name_splash" />
                        <table class="b-layout__table">
                            <tr class="b-layout__tr">
                                  <td class="b-layout__one b-layout__one_padbot_10 b-layout__one_width_80">
                                      <label class="b-layout__txt b-layout__txt_block b-layout__txt_padtop_5" for="new-name">Имя</label>
                                  </td>
                                  <td class="b-layout__one b-layout__one_padbot_10">
                                      <div class="b-combo">
                                            <div class="b-combo__input b-combo__input_width_260">
                                                <input id="new-name" class="b-combo__input-text" name="name" type="text" size="80" value="<?= $user->uname ?>" maxlength="21" />
                                            </div>
                                        </div>
                                  </td>
                            </tr>
                            <tr class="b-layout__tr">
                                <td class="b-layout__one b-layout__one_padbot_10 b-layout__one_width_80">
                                    <label class="b-layout__txt b-layout__txt_block b-layout__txt_padtop_5" for="new-surname">Фамилия</label>
                                </td>
                                <td class="b-layout__one b-layout__one_padbot_10">
                                    <div class="b-combo">
                                        <div class="b-combo__input b-combo__input_width_260">
                                            <input id="new-surname" class="b-combo__input-text" name="surname" type="text" size="80" value="<?= $user->usurname ?>" maxlength="21" />
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr class="b-layout__tr">
                                <td class="b-layout__one b-layout__one_padbot_10 b-layout__one_width_80"><label class="b-layout__txt b-layout__txt_block b-layout__txt_padtop_15" for="userpic">Фотография</label></td>
                                <td class="b-layout__one b-layout__one_padbot_10">
                                    <img id="real_img" class="b-layout__pic b-layout__pic_valign_top" src="<?= $userpicSrc ?>" alt="" width="50" height="50" />

                                        <div id="attach_userpic" class="b-file b-file_padbot_10 b-file_inline-block">
                                           <?
                                           $params = array(
                                               'button_title' => 'Загрузить фотографию',
                                               'maxfiles' => 1,
                                               'maxsize' => 1024 * 1024,
                                               'graph_userpic' => true,
                                               'no_forbidden_formats' => true,
                                           );
                                           ?>
                                           <?= $attachedFiles->getFormTemplate("attachedfiles_finance", 'userpic', $params) ?>
                                        </div>

                                    </td>
                                </tr>
                                <tr class="b-layout__tr">
                                    <td class="b-layout__one b-layout__one_width_80">&#160;</td>
                                    <td class="b-layout__one">
                                        <a href="javascript:void(0)" class="b-button b-button_rectangle_color_green" id="real_name_send">
                                            <span class="b-button__b1">
                                                <span class="b-button__b2">
                                                    <span class="b-button__txt">Сохранить изменения</span>
                                                </span>
                                            </span>
                                        </a>
                                    </td>
                                </tr>
                                <tr class="b-layout__tr">
                                    <td colspan="2" class="b-layout__one">
                                        <div id="real-name-errormessage" class="b-layout__txt b-layout__txt_padleft_80 b-layout__txt_ma b-layout_hide" style="margin-top: 15px;">
                                            <span class="b-icon b-icon_sbr_rattent"></span>
                                            <span id="real-name-errormessage-text">Выберите страницу размещения.</span>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <span class="b-shadow__icon b-shadow__icon_close" onclick="$$('#real-name-overlay').dispose();splashRealNames.setSplashSpecViewed();"></span>
</div>
</div>
<div class="b-shadow__overlay b-shadow__overlay_bg_black" id="real-name-overlay"></div>
<script type="text/javascript">
    (function(){
        window.splashRealNames = {};
        window.addEvent('domready', function(){
            var attachBlock = $('attach_userpic');
            new attachedFiles2(
                attachBlock,
                {
                    session: '<?= $attachedFiles->session[0] ?>',
                    hiddenName: "carusellogo[]",
                    onComplete: function(obj, file){
                        var path = ___WDCPREFIX + '/' + file.path + file.name;
                        $('real_img').set('src', path);
                    }
                },
                '<?= $attachedFiles->session[0] ?>'
            );
            // скрываем список файлов
            attachBlock.getElement('.attachedfiles_table').setStyles({position: 'fixed', left: '-1000px'});
            // отправка формы
            var errorInput;
            $('real_name_send').addEvent('click', function(){
                var name = $('new-name').get('value'),
                    surname = $('new-surname').get('value');
                if (!name.trim() && !surname.trim()) {
                    $('new-name').getParent().addClass('b-combo__input_error');
                    $('new-surname').getParent().addClass('b-combo__input_error');
                    showError('Необходимо ввести имя и фамилию');
                    errorInput = false;
                    return;
                } else if (!name.trim()) {
                    $('new-name').getParent().addClass('b-combo__input_error');
                    showError('Необходимо ввести имя');
                    errorInput = 'name';
                    return;
                } else if (!name.match(/^[-a-zA-Zа-яёА-ЯЁ]+$/)) {
                    $('new-name').getParent().addClass('b-combo__input_error');
                    showError('Имя должно состоять только из букв');
                    errorInput = 'name';
                    return;
                } else if (!surname.trim()) {
                    $('new-surname').getParent().addClass('b-combo__input_error');
                    showError('Необходимо ввести фамилию');
                    errorInput = 'surname';
                    return;
                } else if (!surname.match(/^[-a-zA-Zа-яёА-ЯЁ]+$/)) {
                    $('new-surname').getParent().addClass('b-combo__input_error');
                    showError('Фамилия должна состоять только из букв');
                    errorInput = 'surname';
                    return;
                }
                $('real_name_form').submit();
            });
            
            // открыть требования к файлу
            attachBlock.getElement('.b-fileinfo').addEvent('click', function(){
                $$('.b-fileinfo-shadow').removeClass('b-shadow_hide');
            });
            attachBlock.getElement('.b-shadow__icon_close').addEvent('click', function(){
                $$('.b-fileinfo-shadow').addClass('b-shadow_hide');
            });
            
            // сброс ошибок
            $('new-name').addEvent('focus', function(){
                var parent = this.getParent();
                if (!errorInput || errorInput === 'name') {
                    parent.removeClass('b-combo__input_error')
                    hideError();
                }
            });
            $('new-surname').addEvent('focus', function(){
                var parent = this.getParent();
                if (!errorInput || errorInput === 'surname') {
                    parent.removeClass('b-combo__input_error')
                    hideError();
                }
            });
            
            function showError(text) {
                $('real-name-errormessage-text').set('text', text);
                $('real-name-errormessage').removeClass('b-layout_hide');
            }
            function hideError() {
                $('real-name-errormessage').addClass('b-layout_hide');
            }
            
            // отметить сплэш про СПЕЦИАЛИЗАЦИИ как просмотренный
            splashRealNames.setSplashSpecViewed = function(){
                new Request({
                    url: '/ajax.php',
                    data: {
                        action: 'setSpecSplashViewed',
                        u_token_key: _TOKEN_KEY
                    }
                }).send();
            };
        });
    })()
</script>
